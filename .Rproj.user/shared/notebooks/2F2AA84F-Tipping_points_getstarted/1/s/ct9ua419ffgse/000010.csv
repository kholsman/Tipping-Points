"0","# TBA"
"0","# 3.1. fit Tgam and GAMS PC~stressor system"
"0","#      and Compute the genuine CV (gCV)"
"0","# ------------------------------------"
"0",""
"0","  # use TGAM with no lag"
"0","  years.char <- paste((Data$year), sep = """")"
"0","  "
"0","  TGAM <- threshold.gam(formula(pc1sys~s(pc1str,k=3,by=I(1*(year<=r)))+s(pc1str,k=3,by=I(1*(year>r)))),"
"0","                        a    = 0.1,"
"0","                        b    = 0.9,"
"0","                        data = Data,"
"0","                        threshold.name = 'year',"
"0","                        nthd = 100)"
"0","  summary(TGAM$res)"
"1","
Family:"
"1"," "
"1","gaussian"
"1"," "
"1","
"
"1","Link function:"
"1"," "
"1","identity"
"1"," "
"1","

"
"1","Formula:
"
"1","pc1sys ~ s(pc1str, k = 3, by = I(1 * (year <= r))) + s(pc1str, 
"
"1","    k = 3, by = I(1 * (year > r)))
"
"1","
Parametric coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","   "
"1","
(Intercept)"
"1"," -0.17904"
"1","    0.05967"
"1","  -3.001"
"1","  0.00707"
"1"," **"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","Approximate significance of smooth terms:
"
"1","                            "
"1","   edf"
"1"," Ref.df"
"1","     F"
"1","  p-value"
"1","    "
"1","
s(pc1str):I(1 * (year <= r))"
"1"," 1.667"
"1","  1.667"
"1"," 56.01"
"1"," 2.76e-06"
"1"," ***"
"1","
s(pc1str):I(1 * (year > r)) "
"1"," 1.667"
"1","  1.667"
"1"," 70.58"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","Rank: "
"1",""
"1","6"
"1",""
"1","/"
"1",""
"1","7"
"1",""
"1","
"
"1","R-sq.(adj) = "
"1"," "
"1","0.855"
"1"," "
"1","  "
"1","Deviance explained = "
"1",""
"1","87.4"
"1",""
"1","%"
"1","
"
"1","GCV"
"1",""
"1"," = "
"1",""
"1","0.22396"
"1","  Scale est. = "
"1",""
"1","0.18663 "
"1",""
"1","  n = "
"1",""
"1","24"
"1",""
"1","
"
"0","  "
"0","  # identify the threshold year"
"0"," ggplot(data.frame(rv = TGAM$rv, gcvv = TGAM$gcvv))+"
"0","   geom_line(aes(x=rv,y=gcvv,color=""Regime 1""),size=1.1)+"
"0","   geom_vline(xintercept = TGAM$mr, color = ""gray"",size=1.1)+"
"0","   xlab(""Threshold variable"")+"
"0","   ylab('GCV')+theme_minimal()"
