"0","  "
"0","  "
"0","  #threshold year = 2007"
"0","  TGAM$mr"
"1","[1]"
"1"," 2007.132"
"1","
"
"0","  "
"0","  #quick plot of the TGAM fitted vs observed values"
"0","  Dataup  <- Data%>%filter(year<=round(TGAM$mr)) # upper branch years"
"0","  Datalow <- Data%>%filter(year>round(TGAM$mr))  # lower branch years"
"0","  "
"0","  m       <- gam(pc1sys~s(pc1str, k=3), data=Dataup)"
"0","  n       <- gam(pc1sys~s(pc1str, k=3), data=Datalow)"
"0","  "
"0","  newdata1 <- data.frame(pc1str=runif(1000,min(Dataup$pc1str), max(Dataup$pc1str)))"
"0","  newdata2 <- data.frame(pc1str=runif(1000,min(Datalow$pc1str), max(Datalow$pc1str)))"
"0","  y        <- predict.gam(m,newdata1)"
"0","  z        <- predict.gam(n,newdata2)"
"0",""
"0","  ggplot()+"
"0","    geom_text(data = Data, aes(x=pc1str,y =pc1sys, label = years.char))+"
"0","    geom_line(data = newdata1, aes(x=pc1str,y=y,color=""Regime 1""),size=1.1)+"
"0","    geom_line(data = newdata2, aes(x=pc1str,y=z,color=""Regime 2""),size=1.1)+"
"0","    coord_cartesian("
"0","      ylim = c(min(Data$pc1sys)-sd(Data$pc1sys)/3,"
"0","               max(Data$pc1sys)+sd(Data$pc1sys)/3),"
"0","      xlim = c(min(Data$pc1str)-sd(Data$pc1str)/3,"
"0","               max(Data$pc1str)+sd(Data$pc1str)/3))+"
"0","    theme_minimal()"
"0",""
